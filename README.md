# Minecraft-TCP Client Library

[![Language: C++](https://img.shields.io/badge/Language-C++-blue.svg)](https://isocpp.org/)
[![Standard](https://img.shields.io/badge/C++-17/20-ff69b4.svg)](https://en.cppreference.com/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Platform](https://img.shields.io/badge/Platform-Windows%20%7C%20Linux-lightgrey.svg)]()

ä¸€ä¸ªé«˜æ€§èƒ½ã€ç±»å‹å®‰å…¨çš„ C++ åº“ï¼Œç”¨äºä¸ Minecraft Java Edition æœåŠ¡å™¨å»ºç«‹å’Œç®¡ç†å®Œæ•´çš„ TCP è¿æ¥ã€‚æœ¬é¡¹ç›®å®ç°äº†å®˜æ–¹çš„ Minecraft ç½‘ç»œåè®®ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿæ„å»ºåŠŸèƒ½å¼ºå¤§çš„è‡ªå®šä¹‰å®¢æˆ·ç«¯ã€æœºå™¨äººæˆ–ç›‘æ§å·¥å…·ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

*   **ç±»å‹å®‰å…¨çš„åè®®å®ç°**: åŸºäºæ¨¡æ¿çš„ç¼–è¯‘æ—¶æ•°æ®åŒ…éªŒè¯ç³»ç»Ÿ (`Package<ID, FIELDS>`)ï¼Œç¡®ä¿æ•°æ®åŒ…ç»“æ„å’Œç±»å‹çš„æ­£ç¡®æ€§ï¼Œæœ€å¤§ç¨‹åº¦å‡å°‘è¿è¡Œæ—¶é”™è¯¯ã€‚
*   **å®Œæ•´çš„åè®®çŠ¶æ€æ”¯æŒ**: å…¨é¢æ”¯æŒä»`æ¡æ‰‹` -> `çŠ¶æ€` -> `ç™»å½•` -> `æ¸¸æˆ`çš„å®Œæ•´åè®®ç”Ÿå‘½å‘¨æœŸï¼Œå¤„ç†æ‰€æœ‰å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨é—´çš„æ•°æ®åŒ…äº¤äº’ã€‚
*   **è·¨å¹³å°ç½‘ç»œå±‚**: æŠ½è±¡åŒ–çš„ Socket æ“ä½œï¼Œæ— ç¼æ”¯æŒ Windows (Winsock2) å’Œ Unix-like (POSIX) ç³»ç»Ÿï¼ŒåŒ…å«è‡ªåŠ¨çš„å¹³å°åˆå§‹åŒ–å’Œæ¸…ç†ã€‚
*   **é«˜æ•ˆçš„å¤šçº¿ç¨‹æ¶æ„**: é‡‡ç”¨ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼ï¼Œä½¿ç”¨ç‹¬ç«‹çš„å‘é€å’Œæ¥æ”¶çº¿ç¨‹å¤„ç†ç½‘ç»œ I/Oï¼Œä¿è¯é€šä¿¡æµç•…ä¸”å“åº”è¿…é€Ÿã€‚
*   **ç”Ÿäº§å°±ç»ªçš„è®¾è®¡**: éµå¾ª RAII åŸåˆ™ï¼Œä½¿ç”¨ç°ä»£ C++ï¼ˆ17/20ï¼‰ç‰¹æ€§ï¼ŒåŒ…å«æ™ºèƒ½æŒ‡é’ˆç®¡ç†ã€ç»“æ„åŒ–æ—¥å¿—ç³»ç»Ÿä»¥åŠå¯é…ç½®çš„è°ƒè¯•æ¨¡å¼ã€‚
*   **å¯æ‰©å±•çš„ç±»å‹ç³»ç»Ÿ**: æä¾›ä¸€å¥—å®Œå¤‡çš„ç±»å‹ï¼ˆå¦‚ `Integer`, `String`, `UUID`, `VarNum`ï¼‰å’Œå®ç”¨å·¥å…·ï¼Œä¾¿äºåºåˆ—åŒ–ã€ååºåˆ—åŒ–å’ŒéªŒè¯åè®®æ•°æ®ã€‚

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„æ¦‚è¿°

è¯¥é¡¹ç›®é‡‡ç”¨åˆ†å±‚æ¶æ„ï¼Œå°†ä¸åŒçš„å…³æ³¨ç‚¹åˆ†ç¦»åˆ°æ˜ç¡®çš„æ¨¡å—ä¸­ï¼š

```
+-----------------------+
|   Application Layer   |  <-- ä½ çš„è‡ªå®šä¹‰å®¢æˆ·ç«¯é€»è¾‘æˆ–æœºå™¨äºº
+-----------------------+
            |
+-----------------------+
|   Client Communication|  <-- Client, ClientBase ç±» (è¿æ¥ç®¡ç†, çº¿ç¨‹, é˜Ÿåˆ—)
+-----------------------+
            |
+-----------------------+
|    Protocol System    |  <-- æ•°æ®åŒ…è§£æã€åºåˆ—åŒ–ã€çŠ¶æ€æœº (parsePacket, Package<>)
+-----------------------+
            |
+-----------------------+
|      Type System      |  <-- ç±»å‹å®‰å…¨çš„åŸºå…ƒä¸å¤æ‚ç±»å‹ (Boolean, Integer, String, etc.)
+-----------------------+
            |
+-----------------------+
| Network Infrastructure|  <-- è·¨å¹³å° Socket æŠ½è±¡ (SOCKET, çº¿ç¨‹åŸè¯­)
+-----------------------+
```

### æ ¸å¿ƒç»„ä»¶

| ç»„ä»¶ | ä¸»è¦ç±»/å‡½æ•° | èŒè´£ |
| :--- | :--- | :--- |
| **å®¢æˆ·ç«¯é€šä¿¡** | `Client`, `ClientBase<T>` | TCP è¿æ¥ç®¡ç†ã€çº¿ç¨‹ã€æ¶ˆæ¯é˜Ÿåˆ— |
| **åè®®å¤„ç†** | `parsePacket()`, `Package<ID, FIELDS>` | åè®®çŠ¶æ€ç®¡ç†ã€æ•°æ®åŒ…è§£æä¸æ„å»º |
| **ç±»å‹ç³»ç»Ÿ** | `Boolean<V>`, `Integer<T,V>`, `String<V>`, `UUID<V>`, `VarNum<T,V>` | ç±»å‹å®‰å…¨çš„æ•°æ®åºåˆ—åŒ–ä¸éªŒè¯ |
| **ç½‘ç»œåŸºç¡€è®¾æ–½** | `SOCKET`, çº¿ç¨‹åŸè¯­ | åº•å±‚ç½‘ç»œé€šä¿¡å’Œå¹³å°æŠ½è±¡ |

## ğŸš€ å¿«é€Ÿå¼€å§‹

###  prerequisites

*   **C++ ç¼–è¯‘å™¨**: æ”¯æŒ C++17 æˆ–æ›´é«˜ç‰ˆæœ¬çš„ç¼–è¯‘å™¨ (å¦‚ GCC >= 8, Clang >= 7, MSVC >= 2019)
*   **æ„å»ºç³»ç»Ÿ**: [CMake](https://cmake.org/) (ç‰ˆæœ¬ 3.12 æˆ–æ›´é«˜)
*   **å¯é€‰: æµ‹è¯•æ¡†æ¶**: é¡¹ç›®å¯èƒ½ä¾èµ–å¦‚ Google Test ç­‰æ¡†æ¶ç”¨äºå•å…ƒæµ‹è¯•ã€‚

### æ„å»ºä¸å®‰è£…

1.  **å…‹éš†ä»“åº“**
    ```bash
    git clone <your-repository-url>
    cd minecraft-tcp
    ```

2.  **é…ç½®å¹¶æ„å»º**
    ```bash
    # åˆ›å»ºä¸€ä¸ªæ„å»ºç›®å½•å¹¶è¿›å…¥
    mkdir build && cd build

    # é…ç½® CMake
    # ä½¿ç”¨ -DCMAKE_BUILD_TYPE=Release ç”¨äºå‘å¸ƒç‰ˆæœ¬
    cmake .. -DCMAKE_BUILD_TYPE=Debug

    # å¼€å§‹æ„å»º
    cmake --build . --parallel
    ```
    æ„å»ºåçš„åº“æ–‡ä»¶å’Œå¯æ‰§è¡Œæ–‡ä»¶å°†ä½äº `build` ç›®å½•ä¸‹ã€‚

### åŸºæœ¬ç”¨æ³•

ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨è¯¥åº“è¿æ¥åˆ°æœåŠ¡å™¨å¹¶å®Œæˆæ¡æ‰‹ã€‚

```cpp
#include <client/client.h>
#include <protocol/package/definition.h>
#include <iostream>

int main() {
    try {
        // 1. åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯å®ä¾‹
        minecraft::Client client;

        // 2. è¿æ¥åˆ°æœåŠ¡å™¨
        client.connect("mc.hypixel.net", 25565);

        // 3. å‘é€æ¡æ‰‹åŒ… (ç¤ºä¾‹)
        // å‡è®¾ ProtocolState å’Œ Package ç±»å‹å·²å®šä¹‰
        auto handshake_pkt = minecraft::protocol::create_handshake_packet(
            /* protocol_version */ 762,
            /* server_address */ "mc.hypixel.net",
            /* server_port */ 25565,
            /* next_state */ minecraft::protocol::ProtocolState::Login
        );
        client.sendPacket(handshake_packet);

        // ... å¤„ç†åç»­ç™»å½•é€»è¾‘

        std::cout << "Connected successfully!" << std::endl;

        // 4. è¿›å…¥ä¸»å¾ªç¯æˆ–å¤„ç†äº‹ä»¶
        while (client.isConnected()) {
            // å¤„ç†æ¥æ”¶åˆ°çš„æ•°æ®åŒ…...
            // client.receive(); // é€šå¸¸ç”±åå°çº¿ç¨‹è‡ªåŠ¨å¤„ç†
        }

    } catch (const std::exception& e) {
        std::cerr << "Error: " << e.what() << std::endl;
        return 1;
    }

    return 0;
}
```
*è¯·æ³¨æ„ï¼šä»¥ä¸Šä»£ç ä¸ºæ¦‚å¿µæ€§ç¤ºä¾‹ï¼Œå…·ä½“å‡½æ•°åå’Œåˆ›å»ºæ–¹æ³•è¯·å‚è€ƒå®é™…ä»£ç åº“çš„APIã€‚*

## ğŸ“š æ–‡æ¡£

æ›´æ·±å…¥çš„æ–‡æ¡£å¯ä»¥åœ¨ä»£ç åº“çš„ `docs/` ç›®å½•ä¸‹æ‰¾åˆ°ï¼Œæˆ–è€…é€šè¿‡å†…è”çš„ Doxygen æ³¨é‡Šç”Ÿæˆã€‚

*   **[å¼€å‘ç¯å¢ƒ](./docs/development_environment.md)**: è®¾ç½®å¼€å‘ç¯å¢ƒçš„è¯¦ç»†æŒ‡å—ã€‚
*   **[åè®®ç³»ç»Ÿ](./docs/protocol_system.md)**: è¯¦ç»†è§£é‡Šæ•°æ®åŒ…å®šä¹‰ã€è§£æå’ŒçŠ¶æ€æœºã€‚
*   **[ç±»å‹ç³»ç»Ÿ](./docs/type_system.md)**: æ‰€æœ‰å¯ç”¨ç±»å‹åŠå…¶ç”¨æ³•çš„å®Œæ•´å‚è€ƒã€‚
*   **[å®¢æˆ·ç«¯é€šä¿¡](./docs/client_communication.md)**: å¤šçº¿ç¨‹æ¶æ„å’Œç½‘ç»œç®¡ç†çš„ç»†èŠ‚ã€‚

## ğŸ”§ æ‰©å±•é¡¹ç›®

### æ·»åŠ æ–°çš„æ•°æ®åŒ…

1.  **åœ¨ `protocol/package/definition.h` (æˆ–ç›¸åº”æ–‡ä»¶) ä¸­å®šä¹‰æ•°æ®åŒ…**ï¼š
    ```cpp
    // 1. å®šä¹‰æ•°æ®åŒ…IDï¼ˆå¦‚æœéœ€è¦ï¼‰
    // constexpr int MY_NEW_PACKET_ID = 0x42;

    // 2. å®šä¹‰æ•°æ®åŒ…ç»“æ„
    using MyNewServerBoundPacket = Package<
        MY_NEW_PACKET_ID,
        Field<"SomeField", String<>>,
        Field<"Value", VarInt>
    >;

    // 3. åœ¨æ­£ç¡®çš„åè®®çŠ¶æ€ä¸­æ³¨å†Œå®ƒ
    // template <>
    // struct PacketMapping<ProtocolState::Play, ServerBound> {
    //     ...
    //     using type = std::variant<..., MyNewServerBoundPacket>;
    // };
    ```

2.  **å®ç°åºåˆ—åŒ–/ååºåˆ—åŒ–é€»è¾‘**ï¼ˆå¦‚æœä½¿ç”¨è‡ªå®šä¹‰ç±»å‹ï¼‰ã€‚
3.  **æ›´æ–°çŠ¶æ€æœºæ˜ å°„**ï¼Œç¡®ä¿æ–°æ•°æ®åŒ…åœ¨æ­£ç¡®çš„åè®®çŠ¶æ€ä¸‹è¢«è§£æå’Œå¤„ç†ã€‚

### æ·»åŠ æ–°çš„æ•°æ®ç±»å‹

1.  åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»å‹æ¨¡æ¿ï¼Œå¹¶ä¸ºå…¶å®ç° `serialize` å’Œ `deserialize` æ–¹æ³•ã€‚
2.  ç¡®ä¿å®ƒç¬¦åˆåº“ç±»å‹ç³»ç»Ÿæ‰€è¦æ±‚çš„æ¦‚å¿µï¼ˆå¦‚ `Serializable`ï¼‰ã€‚
3.  åœ¨ `type system` æ–‡æ¡£ä¸­è®°å½•å®ƒçš„ç”¨æ³•ã€‚

## ğŸ¤ å¦‚ä½•è´¡çŒ®

æˆ‘ä»¬æ¬¢è¿ä»»ä½•å½¢å¼çš„è´¡çŒ®ï¼è¯·éšæ—¶ Fork æœ¬é¡¹ç›®å¹¶æäº¤ Pull Requestã€‚

1.  Fork æœ¬ä»“åº“
2.  åˆ›å»ºæ‚¨çš„ç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3.  æäº¤æ‚¨çš„æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4.  æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5.  å¼€å¯ä¸€ä¸ª Pull Request

åœ¨è´¡çŒ®ä¹‹å‰ï¼Œè¯·é˜…è¯» `CONTRIBUTING.md`ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ä»¥äº†è§£æˆ‘ä»¬çš„ç¼–ç è§„èŒƒå’Œæµ‹è¯•è¦æ±‚ã€‚

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº **MIT è®¸å¯è¯** - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

*   æ„Ÿè°¢ [Mojang Studios](https://www.minecraft.net/) æä¾›äº† Minecraft åŠå…¶å…¬å¼€çš„ç½‘ç»œåè®®è§„èŒƒã€‚
*   æ„Ÿè°¢æ‰€æœ‰ä¸ºæ­¤é¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…ã€‚

## ğŸ› ï¸ æŠ€æœ¯æ”¯æŒ

å¦‚æœæ‚¨é‡åˆ°ä»»ä½•é—®é¢˜æˆ–æœ‰ç–‘é—®ï¼Œè¯·é‡‡å–ä»¥ä¸‹æ­¥éª¤ï¼š
1.  **é¦–å…ˆ**ï¼ŒæŸ¥çœ‹ [æ–‡æ¡£](./docs) å’Œç°æœ‰çš„ [Git Issues](issues)ã€‚
2.  å¦‚æœæ‰¾ä¸åˆ°ç­”æ¡ˆï¼Œè¯·**å¼€å¯ä¸€ä¸ªæ–° Issue**ï¼Œæ¸…æ™°æè¿°æ‚¨çš„é—®é¢˜ã€é”™è¯¯æ—¥å¿—ä»¥åŠå¤ç°æ­¥éª¤ã€‚

---

**Happy Coding!** ğŸ®